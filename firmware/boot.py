import supervisor
import usb_hid

RAWHID_REPORT_DESCRIPTOR = bytes((
  0x06, 0x00, 0xff,              # Usage page (Vendor Defined Page1)
  0x09, 0x01,                    # Usage (Vendor Page 1)
  0xa1, 0x01,                    # Collection (Application)
  0x85, 0x01,                    #     ReportID (1)
  0x09, 0x00,                    #     Usage (Undefined)
  0x35, 0x00,                    #     PhysicalMinimum (0)
  0x46, 0x68, 0x01,              #     PhysicalMaximum (360)
  0x15, 0x00,                    #     LogicalMinimum (0)
  0x27, 0xff, 0xff, 0x00, 0x00,  #     LogicalMaximum (65535)
  0x65, 0x14,                    #     Unit (Degree)
  0x55, 0x00,                    #     UnitExponent (0)
  0x95, 0x01,                    #     ReportCount (1)
  0x75, 0x10,                    #     ReportSize (16)
  0x81, 0x0a,                    #     Input (Variable|Wrap)
  0x85, 0x02,                    #     ReportID (2)
  0x09, 0x00,                    #     Usage (Undefined)
  0x35, 0xf1,                    #     PhysicalMinimum (-15)
  0x45, 0x5a,                    #     PhysicalMaximum (90)
  0x15, 0x00,                    #     LogicalMinimum (0)
  0x27, 0xff, 0xff, 0x00, 0x00,  #     LogicalMaximum (65535)
  0x65, 0x14,                    #     Unit (Degree)
  0x55, 0x00,                    #     UnitExponent (0)
  0x95, 0x01,                    #     ReportCount (1)
  0x75, 0x10,                    #     ReportSize (16)
  0x81, 0x02,                    #     Input (Variable)
  0x85, 0x03,                    #     ReportID (3)
  0x09, 0x00,                    #     Usage (Undefined)
  0x35, 0x00,                    #     PhysicalMinimum (0)
  0x46, 0x68, 0x01,              #     PhysicalMaximum (360)
  0x15, 0x00,                    #     LogicalMinimum (0)
  0x27, 0xff, 0xff, 0x00, 0x00,  #     LogicalMaximum (65535)
  0x65, 0x14,                    #     Unit (Degree)
  0x55, 0x00,                    #     UnitExponent (0)
  0x95, 0x01,                    #     ReportCount (1)
  0x75, 0x10,                    #     ReportSize (16)
  0x91, 0x0a,                    #     Output (Variable|Wrap)
  0x85, 0x04,                    #     ReportID (4)
  0x09, 0x00,                    #     Usage (Undefined)
  0x35, 0xf1,                    #     PhysicalMinimum (-15)
  0x45, 0x5a,                    #     PhysicalMaximum (90)
  0x15, 0x00,                    #     LogicalMinimum (0)
  0x27, 0xff, 0xff, 0x00, 0x00,  #     LogicalMaximum (65535)
  0x65, 0x14,                    #     Unit (Degree)
  0x55, 0x00,                    #     UnitExponent (0)
  0x95, 0x01,                    #     ReportCount (1)
  0x75, 0x10,                    #     ReportSize (16)
  0x91, 0x02,                    #     Output (Variable)
  0x85, 0x05,                    #     ReportID (5)
  0x09, 0x00,                    #     Usage (Undefined)
  0x15, 0x81,                    #     LogicalMinimum (-127)
  0x25, 0x7f,                    #     LogicalMaximum (127)
  0x65, 0x00,                    #     Unit (0)
  0x55, 0x00,                    #     UnitExponent (0)
  0x95, 0x01,                    #     ReportCount (1)
  0x75, 0x08,                    #     ReportSize (8)
  0x91, 0x06,                    #     Output (Variable|Relative)
  0x09, 0x00,                    #     Usage (Undefined)
  0x15, 0x81,                    #     LogicalMinimum (-127)
  0x25, 0x7f,                    #     LogicalMaximum (127)
  0x65, 0x00,                    #     Unit (0)
  0x55, 0x00,                    #     UnitExponent (0)
  0x95, 0x01,                    #     ReportCount (1)
  0x75, 0x08,                    #     ReportSize (8)
  0x91, 0x06,                    #     Output (Variable|Relative)
  0xc0,                          # EndCollection
))

raw_hid = usb_hid.Device(
    report_descriptor=RAWHID_REPORT_DESCRIPTOR,
    usage_page=0xFF00,
    usage=0x01,
    report_ids=(1,2,3,4,5),
    in_report_lengths=(4,4,0,0,0),
    out_report_lengths=(0,0,2,2,2),
)

#supervisor.set_usb_identification("friggeri.net", "pan-tilt", 0x1209, 0x2311)
supervisor.set_usb_identification("friggeri.net", "pan-tilt", 0x2E8A, 0x101A)
usb_hid.enable((raw_hid,))